<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
    <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">
    <title>CONTENIDO - Writing modules for use with CONTENIDO</title>
    <link rel="stylesheet" href="../assets/techref.css" type="text/css" media="all">
</head>

<body>

<div id="header">
    <img src="../assets/conlogo.gif" alt="CONTENIDO Logo">
    <h1>Writing modules for use with CONTENIDO</h1>
</div>

<div class="section">
  <table class="info" border="0" cellpadding="2" cellspacing="2">
    <tbody>
      <tr>
        <td>Author</td>
        <td>Timo A. Hummel</td>
      </tr>
      <tr>
        <td>Created</td>
        <td>3rd November 2003</td>
      </tr>
      <tr>
        <td>Audience</td>
        <td>Module Developers</td>
      </tr>
      <tr>
        <td>Applies to</td>
        <td>CONTENIDO 4.4 or later</td>
      </tr>
    </tbody>
  </table>
</div>

<div class="section">
<h2>Introduction</h2>
Writing modules with CONTENIDO is as easy as writing regular PHP code.
You don't get a stripped-down development environment, but rather you
get a combination of CONTENIDO's CMS features combined with your own
code.
</div>

<div class="section">
<h2>What's input, what's output, what's a module anyways?</h2>
A module is nothing more than a piece of code which gets combined using
a template:<br>
<br>
<img src="output-gen.jpg" alt="" style="width: 427px; height: 176px;"><br>
<br>
As you already know, a layout contains placeholders for modules. The
PHP-Code from the module's output sections are inserted into the
correct positions in the layout. The input section is not relevant for
the output, but the input section is relevant for configuring the
modules.
</div>

<div class="section">
<h2>Configuration magic</h2>
To make modules more "modular", you can configure them. You might have
seen this in the predefined modules - but how does it work?<br>
<br>
The configuration data is stored transparently, so you don't need to
worry to get your configuration data from the input section to the
output section. Storing configuration data is pretty easy. Take a look
at this simple example of an input section:<br>
<br>
<pre>
echo '&lt;table&gt;
          &lt;tr&gt;
              &lt;td&gt;Test&lt;/td&gt;
              &lt;td&gt;&lt;input type="text" name="CMS_VAR[1]" value="CMS_VALUE[1]"&gt;&lt;/td&gt;
          &lt;/tr&gt;
      &lt;/table&gt;';
</pre>
CMS_VAR[x] is the variable (which is set using "magic" :)) to "receive"
the desired value, and CMS_VALUE[x] is the current value. The same
story goes for the output area:<br>
<pre>echo "CMS_VALUE[1]";</pre>
To avoid problems, you should always take care of the following things:<br>
<ul>
  <li>Always store your configuration into local variables (e.g. $foo =
"CMS_VALUE[1]";)</li>
  <li>Always use quotes around CMS_VALUE, as CMS_VALUE is text.</li>
  <li>PHP allows transparent type switching, so the following code will
also work:<br>
    <pre>
$foo = "CMS_VALUE[1]";
if ($foo == 1) {
    echo "Worked";
}
</pre>
  </li>
</ul>
</div>

<div class="section">
<h2>Important System stuff</h2>
If you want to write advanced modules, you might want to interact with
CONTENIDO. Here are a few objects and functions you can use with your
modules.<br>
<br>
<table class="full" border="1" cellspacing="2" cellpadding="2">
  <tbody>
    <tr>
      <td>cDb</td>
      <td>The well-known PHPLib DB-Object.
      <br>
      <br>
Example:<br>
      <br>
<pre>
$mydb = cRegistry::getDb();<br>
$mydb-&gt;query("SELECT * FROM test");<br>
</pre>
      <br>
Reference:<br>
See
http://www.sanisoft.com/phplib/manual/DB_SqlMethods.php#DB_SqlMethodsInt<br>
      <br>
You should always use $cfg["tab"][*] to access CONTENIDO tables.<br>
      <br>
Warning: You should never ever use $db in your modules. Always use your
own variables.<br>
      </td>
    </tr>
    <tr>
      <td>$sess</td>
      <td>The current session. Useful variables:<br>
      <br>
$sess-&gt;id (current session ID)<br>
      </td>
    </tr>
    <tr>
      <td>$auth<br>
      </td>
      <td>Authentification information. Useful variables:<br>
      <br>
$auth-&gt;auth["uid"] (current user ID)<br>
$auth-&gt;auth["uname"] (current user name)<br>
      </td>
    </tr>
  </tbody>
</table>
</div>

</body>
</html>
